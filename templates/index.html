<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MRI Brain Tumor Detector</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="page">
    <header class="header">
        <h1>MRI Brain Tumor Detector</h1>
        <p class="subtitle">
            Upload a brain MRI image to get a tumor prediction.<br>
            <strong>Important:</strong> This tool is for <strong>educational purposes only</strong> and is
            <strong>not</strong> a medical diagnostic device.
        </p>
    </header>

    <main class="main">
        <section class="card">
            <h2>Upload MRI Image</h2>
            <form action="/" method="POST" enctype="multipart/form-data" class="upload-form">
                <label for="file">Choose an MRI image (PNG / JPG):</label>
                <input type="file" id="file" name="file" accept="image/*" required>

                <button type="submit">Analyze Image</button>
            </form>

            <div class="preview">
                <p class="preview-title">Selected image preview:</p>
                <div class="preview-box">
                    <img 
                        id="preview-img" alt="Upload an MRI image to preview it here.">
                </div>
            </div>
        </section>
                {% if heatmap_url %}
        <section class="card">
            <h2>Tumor Heatmap (Grad-CAM)</h2>
            <img src="{{ heatmap_url }}" class="heatmap-img">
        </section>
        {% endif %}


        {% if result %}
        <section
            class="card result
            {% if 'TUMOR DETECTED' in result %}
                result-danger
            {% else %}
                result-safe
            {% endif %}">
            <h2>Prediction Result</h2>
            <p class="result-text">{{ result }}</p>
            <p class="result-note">
                Confidence is the probability estimated by the model.
            </p>
        </section>
        {% endif %}

        <section class="card">
            <h2>Model & Dataset Info</h2>
            <ul class="info-list">
                <li><strong>Model:</strong> ResNet-18 (fine-tuned for binary tumor detection).</li>
                <li><strong>Output:</strong> Single probability value (0–1) using sigmoid.</li>
                <li><strong>Threshold:</strong> ≥ 0.5 → Tumor detected.</li>
                <li><strong>Disclaimer:</strong> Demo/educational use only.</li>
            </ul>
        </section>
    </main>

    <footer class="footer">
        <p>MRI Tumor Detector · Flask + PyTorch</p>
    </footer>
</div>

<script>
    const fileInput = document.getElementById('file');
    const previewImg = document.getElementById('preview-img');

    fileInput.addEventListener('change', function () {
        const file = this.files[0];

        if (!file) {
            previewImg.src = "";
            previewImg.alt = "No image selected";
            return;
        }

        const reader = new FileReader();
        reader.onload = function (e) {
            previewImg.src = e.target.result;
            previewImg.alt = "Uploaded MRI scan";
        };
        reader.readAsDataURL(file);
    });
</script>

</body>
</html>
